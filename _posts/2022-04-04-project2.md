---
title:  "Project 2: Avocado Price Comparison In South Florida Cities"
mathjax: false
layout: post
categories: media
---

In this report, I will be exploring data from the [Hass Avocado Board]( https://hassavocadoboard.com/) and the [Kaggle Avocado Price (2020)]( https://www.kaggle.com/datasets/timmate/avocado-prices-2020) data set. The focus of this project is to compare prices of avocados in Tampa vs Miami Florida. 


Downloaded data contained the following fields: 

|Volume Data Projections| Avocado Prices
|------|-----|
|week|date|
|year|average price|
|status|total volume|
|total volume|plu4046|
|California|plu4225|
|Chile|plu4770|
|Mexico|total bags|
|Peru|small bags|
|Colombia|large bags|
|Dominican Republic|xlarge bags|
|-| type|
|-| year|
|-| region|

## Data Cleaning
- Combined the most recent (2021) price data from Hass to the Kaggle database using EXCEL
- Combined Volume Data Projects from 2019- 2022 into one table using EXCEL
- Corrected capitalization in the ‘type’ column to reflect the Kaggle dataset
- Filtered and removed all regions except Tampa, Miami and TotalUs

While cleaning, I noticed several issues with the datasets. For instance, small, large and xlarge bag size values were missing from 2018-2020. Historical volume import data was limited to 2019 and beyond, while price data stretched back to 2015.  The import volume data for 2022 is constantly updating, while the price data for the first quarter of 2022 is not available for comparison at this time. These discrepancies led me to focus solely on price. 

**To view the SQL code with this report, visit:**
[sjphilippe github](https://github.com/sjphilippe/Project2)


## Avocado Hypoth
 

Initially I assume that Miami would have lower avocado prices due to the heavy Caribbean and Hispanic influence in South Florida. In my experience, most houses grow fruiting trees, including mango, papaya and avocado. I’ve personally had home grown avocados from a family tree towering well over 20 feet. With this information, I believed that the readily local supply of avocados would compete with those imported.  Instead, I found that avocados are actually less expensive in Tampa compared to Miami. 


## Analysis

I first wanted to see when avocado prices in Tampa and Miami were above or below the Us average. To accomplish this, I created a CTE to separate the US region from Florida regions. I then assigned conditions to the specific cases I wanted to compare against. I’ve added comments under the WHERE clause to explain how to adjust the query for specific outputs. The query is as follows: 

```sql
WITH table1 AS (SELECT ROUND(avg_price,2) AS usavg, date, type
FROM florida_avo
WHERE region = 'TotalUS') 

SELECT region, fa.date, usavg, ROUND(avg_price,2) AS city_price, t1.type,
CASE WHEN fa.avg_price < usavg THEN 'Below'
	WHEN fa.avg_price > usavg THEN 'Above'
	ELSE 'Matching' END AS price_flux
FROM florida_avo AS fa
JOIN table1 AS t1
ON t1.date = fa.date
	AND t1.type = fa.type
WHERE 
	-- t1.type = 'organic' AND --> filter by type of avo(organic/conventional)
	region != 'TotalUS' AND -- excludes total us AS region value 
	region = 'Tampa' AND -->filter by region(s). exclude to show all. 
	 year BETWEEN '2019' AND '2021'
ORDER BY fa.date, region
```

Looking at the image below, you can see that from 2019- 2021, Miami prices have always been above Tampa for both organic and conventional avocados.  There are noticeable price patterns, with price increasing the second quarter of the year, followed by a sharp decrease in the third and fourth quarter. The graph also shows that organic avocado price in South Florida is frequently below US average, which conventional avocado prices tend to be above the US average in the second yearly quarter. 


![](/assets/img/avo/Organic%20%26%20Conventional%20Comparison.png)

To quantify how often prices in Tampa/Miami are above US average, I took the above query and modified it by adding the main query as a second CTE. I then used arithmetic operators to find the percentage that avocado prices were below the us average per year.  The query is as follows: 

```sql
WITH table1 AS (SELECT ROUND(avg_price,2) AS usavg, date, type
FROM florida_avo
WHERE region = 'TotalUS'),

table2 AS (SELECT region, fa.date, usavg, ROUND(avg_price,2) AS city_price, t1.type, year,
CASE WHEN fa.avg_price < usavg THEN 'Below' END AS pricebelow,
CASE WHEN fa.avg_price > usavg THEN 'Above' END AS priveabove,
CASE WHEN fa.avg_price = usavg THEN 'Matching' END AS sameprice
FROM florida_avo AS fa
JOIN table1 AS t1
ON t1.date = fa.date
	AND t1.type = fa.type
WHERE 
	region != 'TotalUS' AND --> excludes total us AS region value 
	year BETWEEN '2019' AND '2021' --> filter by year here
ORDER BY fa.date, fa.region)

SELECT distinct region, year, 
	count(priveabove)/2 AS timesabove_usavg, --> count()/2 because query counts organic & conventional prices AS separate weeks.
	count(pricebelow)/2 AS timesbelow_usavg,
	count(sameprice)/2 AS timesmatching_usavg,
	count(pricebelow)/2*100/(count(priveabove)/2 + count(pricebelow)/2) AS perc_below_usavg
FROM table2 
GROUP BY region, year
ORDER BY region, year
```
 
The above query concluded that avocado prices in Tampa were below US average at 90%, 94% and 91% of the year in 2019, 2020, and 2021 respectively. For comparison Miami prices were below us average at 72%, 75% and 72% of the year in 2019, 2020, and 2021. 


To do:
- [x] add con/org price graph and related query 
- [] add import graph
- [] add price avg 2015- current graph
- [] add the other queries 
- [] include reflection 
